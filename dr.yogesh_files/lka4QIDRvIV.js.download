;/*FB_PKG_DELIM*/

__d("IGDLegacyTLCBundleResource",["IGDLegacyTLCMainWebWorkerResource"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("IGDLegacyTLCMainWebWorkerResource")}),98);
__d("MAWLoadDbMigrationVersion",["MAWCurrentUser","MAWDBMigrationUtils","MAWDbAppMeta","MAWDbObjEncryption","MAWIndexedDbMetadata","MWEARKeychainV3","Promise","WATagsLogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] "," blocked"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] "," error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] Error accessing appMeta: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] Request error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] Transaction error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MAWLoadDbMigrationVersion] "," onupgradeneeded - closing db"]);n=function(){return a};return a}var o=d("WATagsLogger").TAGS(["DB","MIGRATION_VERSION"]);function a(a){var c=d("MAWCurrentUser").getID(),e=d("MAWIndexedDbMetadata").dbName(c);return new(h||(h=b("Promise")))(function(c){if(!indexedDB){c();return}var f=indexedDB.open(e);f.onupgradeneeded=function(a){a.target.transaction.abort();a=a.target.result;o.LOG(n(),e);a==null?void 0:a.close();c()};f.onsuccess=function(e){var f=e.target.result;if(f==null){c();return}try{e=f.transaction("appMeta","readonly");e.onerror=function(a){o.LOG(m(),(a=a.target.error)==null?void 0:a.message);f.close();c()};e=e.objectStore("appMeta");e=e.get(d("MAWDbAppMeta").AppMetaKeysEnum.dbMigrationVersion);e.onerror=function(a){o.LOG(l(),(a=a.target.error)==null?void 0:a.message);f.close();c()};e.onsuccess=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){f.close();b=b.target.result;yield d("MWEARKeychainV3").waitForDbEncryptionNamespace("maw_ear");if(b!=null){b=d("MAWDbObjEncryption").decryptDbObj(babelHelpers["extends"]({},b),"appMeta",a);b=b.value.dbMigrationVersion;b!=null&&(d("MAWDBMigrationUtils").mawDbMigrationVersion.version=b)}c()});return function(a){return e.apply(this,arguments)}}()}catch(a){o.LOG(k(),a.message),f.close(),c()}};f.onerror=function(a){o.LOG(j(),e,a==null?void 0:(a=a.target)==null?void 0:(a=a.error)==null?void 0:a.message);c()};f.onblocked=function(a){a=a.target.result;o.LOG(i(),e);a==null?void 0:a.close()}})}g["default"]=a}),98);